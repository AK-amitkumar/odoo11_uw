/**
 * CFPrint打印类
 * ver 1.2
 * 康虎软件工作室
 * Email: wdmsyf@sina.com
 * QQ: 360026606
 * 微信: 360026606
 */
if(typeof CFConnState=="undefined")var CFConnState={CONNECTING:0,OPEN:1,CLOSING:2,CLOSED:3};if(typeof(CFPrint)=="undefined")var CFPrint={_ver:"1.2",wsProtocol:"ws",wsAddress:"127.0.0.1",wsPort:54321,rptTemplate:"waybill_huaxia3.fr3",binaryType:"arraybuffer",websocket:null,isReady:false,dataList:[],OnOpen:function($){if(console)console.log("WebSocket opened.")},OnClose:function($){if(console)console.log("WebSocket Closed.")},OnMessage:function($){if(console)console.log("A message received.")},OnError:function($){if(console)console.log("A error occured.")},DebugFunc:function($){if(console)console.log($)},createNew:function(_,A){var $={};$.setIsHttps=function($){CFPrint.wsProtocol=$?"wss":"ws"};$.setAddress=function($){CFPrint.wsAddress=$};$.setPort=function($){CFPrint.wsPort=$};$.setRptTemplate=function($){CFPrint.rptTemplate=$};$.setBinaryType=function($){CFPrint.binaryType=$};$.setOnOpen=function($){CFPrint.OnOpen=$};$.setOnClose=function($){CFPrint.OnClose=$};$.setOnMessage=function($){CFPrint.OnMessage=$};$.setOnError=function($){CFPrint.OnError=$};$.setDebug=function($){CFPrint.DebugFunc=$};$.isReady=function(){return CFPrint.isReady};$.version=function(){return CFPrint._ver};if(typeof(_)!="undefined")CFPrint.wsAddress=_;if(typeof(A)!="undefined")CFPrint.wsPort=A;$.connect=function(){if(typeof(CFPrint.websocket)=="undefined"||CFPrint.websocket==null||CFPrint.websocket.readyState!=CFConnState.OPEN){CFPrint.websocket=new WebSocket(CFPrint.wsProtocol+"://"+CFPrint.wsAddress+":"+CFPrint.wsPort);CFPrint.websocket.onopen=function($){CFPrint.DebugFunc("WebSocket CONNECTED");CFPrint.isReady=true;while(CFPrint.dataList.length>0)CFPrint.websocket.send(CFPrint.dataList.pop());CFPrint.OnOpen($)};CFPrint.websocket.onclose=function($){CFPrint.DebugFunc("WebSocket CLOSED");CFPrint.isReady=false;CFPrint.dataList.length=0;CFPrint.OnClose($)};CFPrint.websocket.onmessage=function($){CFPrint.DebugFunc("WebSocket recevied a message: "+$.data);CFPrint.OnMessage($)};CFPrint.websocket.onerror=function($){CFPrint.DebugFunc("A error occured: "+$.data);CFPrint.OnError($)}}};$.open=$.connect;$.send=function($){if(!CFPrint.isReady)CFPrint.dataList.push($);else CFPrint.websocket.send($)};return $}}